<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Baseball Game</title>
</head>

<body>
  <script>
  console.log('Let\'s Start!');
  alert('Let\'s Start!');
    var list = [];
    for (var i = 0; i < 10; i++) {
      list[i] = i;
    }
    var num = [];
    for (var i = 0; i < 4; i++) {
      var select = Math.floor(Math.random() * list.length);
      num[i] = list.splice(select, 1)[0];
    }
    var count = 0;
    while (count < 10) {
      count++;
      var inputStr, wrongInput, strike, ball;
      var input = prompt('0~9 중 서로 다른 숫자 4자리 입력! (ex.0123)');
      var inputArr = input.split('');
      for (var i = 0; i < 4; i++) {
        inputArr[i] = Number(inputArr[i]);
      }
      for (var j = 0; j < 4; j++) {
        if (isNaN(inputArr[j])===true) {
          inputStr = true;
          break;
        }else{
          inputStr = false;
        }
      }
      if (input == undefined) {
        console.log('게임 종료');
        alert('게임 종료');
        break;
      } else if (input.length !== 4 || inputStr===true) {
        wrongInput = true;
        count--;
      } else {
        wrongInput = false;
        inputStr = false;
        strike = 0;
        ball = 0;
        var overlap;
        for (var j = 0; j < 4; j++) {
          for (var l = 0; l < 4; l++) {
            if (j !== l && inputArr[j] === inputArr[l]) {
              overlap = true;
              break;
            }
          }
          for (var k = 0; k < 4; k++) {
            if (num[j] == inputArr[k]) {
              if (j === k) {
                strike++;
              } else {
                ball++;
              }
              break;
            }
          }
        }
        if (overlap === true) {
          console.log('같은 숫자 여러번 입력함');
          alert('같은 숫자 여러번 입력함');
          overlap = false;
        }
      }
      if (strike === 4) {
        console.log('홈런! ' + (count) + '번 만에 맞춤!');
        alert('홈런! ' + (count) + '번 만에 맞춤!');
        break;
      } else if (wrongInput === true) {
        console.log('4자리 숫자만 입력해');
        alert('4자리 숫자만 입력해');
      } else {
        console.info(count + '번째 시도\n' + inputArr.join('') + ': ' + strike + '스트라이크 ' + ball + '볼\n' + (10 - count) + '번 남음');
        alert(count + '번째 시도\n' + inputArr.join('') + ': ' + strike + '스트라이크 ' + ball + '볼\n' + (10 - count) + '번 남음');
      }
    }
    if (count >= 10) {
      console.error('시도 횟수 초과');
      alert('시도 횟수 초과');
      document.write('Game Over');
    } else {
      console.error('Congraturation!');
      alert('Congraturation!');
      document.write('홈런 축하!!');
    }
  </script>
</body>

</html>
